---
import Layout from '../layouts/Layout.astro';
import WordCard from '../components/WordCard.astro';
import { getToday, getWordForDate, formatDisplayDate, getPrevDate } from '../lib/words';

const db = Astro.locals.runtime.env.DB;
const today = getToday();
const word = await getWordForDate(db, today);
const displayDate = formatDisplayDate(today);
const prevDate = await getPrevDate(db, today);
---

<Layout>
  {word ? (
    <WordCard word={word} date={today} displayDate={displayDate} />
  ) : (
    <article class="word-card">
      <p class="word-date">{displayDate}</p>
      <h1 class="word-title">Geen woord vandaag</h1>
      <p class="word-explanation">Er is nog geen woord voor vandaag toegevoegd.</p>
    </article>
  )}
  <nav class="word-nav">
    {prevDate && <a href={`/archive/${prevDate}`}>&larr; Vorige</a>}
    <a href="/archive">Archief &rarr;</a>
  </nav>
</Layout>
